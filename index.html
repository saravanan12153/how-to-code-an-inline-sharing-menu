<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="initial-scale=1">
    <meta name="description" content="Lazy load image with blurry effect as seen on Medium">

    <meta property="og:url" content="https://tfirdaus.github.io/inline-sharing-button/" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Inline Sharing Buttons" />
    <meta property="og:description" content="Show inline sharing button on top of highlighted text" />
    <meta property="og:image" content="https://tfirdaus.github.io/inline-sharing-button/images/office-4.jpg" />
    <meta property="fb:app_id" content="101402859970084" />

    <title>Inline Sharing Button</title>

    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.6&appId=101402859970084";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

	<header class="site-header cf">
        <h1>Inline Sharing Button</h1>
        <a href="#">Read Tutorial</a>
    </header>

    <p id="help">Select text from the following paragraphs.</p>

    <div id="content" class="demo-content">
        <p>Embedding a Youtube video has become a completely normal process for anyone involved with the web; copy, paste, done. However, pulling in an external resource like a Youtube video may slow down a web pageâ€™s load performance, especially if there are two or more videos embedded on the same page.</p>

        <p>By embedding videos we request more than just a video file. A number of resources are fetched, including JavaScript files, a stylesheet, images, and advertisements. And as you can from the screenshot below, two Youtube videos equates to 22 HTTP requests with a total of 624kb downloaded. These numbers will climb as we embed more videos on the page.</p>
    </div>
    <div id="share-bubble" class="tooltip">
        <div class="tooltip__buttons">
            <button id="share" title="Share">
                <svg class="icon icon--facebook" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512; width: 24px; height: 24px" xml:space="preserve"><g></g><g><g><path d="M426.8,64H85.2C73.5,64,64,73.5,64,85.2l0,341.6c0,11.7,9.5,21.2,21.2,21.2H256V296h-45.9v-56H256v-41.4 c0-49.6,34.4-76.6,78.7-76.6c21.2,0,44,1.6,49.3,2.3v51.8l-35.3,0c-24.1,0-28.7,11.4-28.7,28.2V240h57.4l-7.5,56H320v152h106.8 c11.7,0,21.2-9.5,21.2-21.2V85.2C448,73.5,438.5,64,426.8,64z"/></g></g></svg>
            </button>
            <button id="tweet" title="Tweet">
                <svg class='icon icon--twitter' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512; width: 24px; height: 24px' xml:space='preserve'><path d='M492,109.5c-17.4,7.7-36,12.9-55.6,15.3c20-12,35.4-31,42.6-53.6c-18.7,11.1-39.4,19.2-61.5,23.5
                    C399.8,75.8,374.6,64,346.8,64c-53.5,0-96.8,43.4-96.8,96.9c0,7.6,0.8,15,2.5,22.1c-80.5-4-151.9-42.6-199.6-101.3
                    c-8.3,14.3-13.1,31-13.1,48.7c0,33.6,17.2,63.3,43.2,80.7C67,210.7,52,206.3,39,199c0,0.4,0,0.8,0,1.2c0,47,33.4,86.1,77.7,95
                    c-8.1,2.2-16.7,3.4-25.5,3.4c-6.2,0-12.3-0.6-18.2-1.8c12.3,38.5,48.1,66.5,90.5,67.3c-33.1,26-74.9,41.5-120.3,41.5
                    c-7.8,0-15.5-0.5-23.1-1.4C62.8,432,113.7,448,168.3,448C346.6,448,444,300.3,444,172.2c0-4.2-0.1-8.4-0.3-12.5
                    C462.6,146,479,129,492,109.5z'/>
                </svg>
            </button>
        </div>
        <span class="tooltip__triangle"></span>
    </div>

    <script>

        var bubble = document.getElementById( 'share-bubble' );

        function openShareWindow( url, w, h ) {

            var screenLeft = window.screenLeft !== undefined ? window.screenLeft : screen.left;
            var screenTop = window.screenTop !== undefined ? window.screenTop : screen.top;
            var width = window.innerWidth ? window.innerWidth : doc.documentElement.clientWidth ? doc.documentElement.clientWidth : screen.width;
            var height = window.innerHeight ? window.innerHeight : doc.documentElement.clientHeight ? doc.documentElement.clientHeight : screen.height;

            var left = ( ( width / 2 ) - ( w / 2 ) ) + screenLeft;
            var top = ( ( height / 2 ) - ( h / 2 ) ) + screenTop;

            var newWin = window.open( url, "", "scrollbars=no,width=" + w + ",height=" + h + ",top=" + top + ",left=" + left );

            if ( newWin ) {
                newWin.focus();
            }

        }

        function getHighlight() {

            var selection = window.getSelection();

            var object = {
                parent : null,
                text   : '',
                rect : null
            };

            if ( selection.rangeCount > 0 ) {
                object = {
                    parent : selection.anchorNode.parentNode,
                    text   : selection.toString().trim(),
                    rect   : selection.getRangeAt(0).getBoundingClientRect()
                };
            }

            return object;
        }

        function showBubble() {

            var highlight = getHighlight();

            if ( highlight.text === '' ) {

                bubble.setAttribute( 'class', 'tooltip' );
                bubble.style.left = 0;
                bubble.style.top  = 0;

                return;
            }

            if ( highlight.parent.nodeName !== 'P' ) {
                return;
            }

            var width = ( highlight.rect.width / 2 ) - 42;

            bubble.setAttribute( 'class', 'tooltip tooltip--shown' );
            bubble.style.left = ( highlight.rect.left + width ) + "px";
            bubble.style.top  = ( highlight.rect.top - 48 ) + "px";
        }

        // Upon releasing mouse button.
        document.body.addEventListener( 'mouseup', function() {
             setTimeout( showBubble, 30 );
        } );

        // Facebook.
        document.getElementById( 'share' ).addEventListener( 'click', function() {

            var highlight = getHighlight();

            if ( highlight.text !== '' && highlight.parent.nodeName === 'P' ) {
                FB.ui({
                    method : 'share',
                    mobile_iframe: true,
                    href   : window.location.href,
                    quote  : highlight.text
                }, function(response){});
            }

            event.preventDefault();
        } );

        // Tweet.
        document.getElementById( 'tweet' ).addEventListener( 'click', function() {

            var highlight = getHighlight();

            if ( highlight.text !== '' && highlight.parent.nodeName === 'P' ) {

                var docURL = encodeURIComponent( window.location.href );
                var tweetText = encodeURIComponent( highlight.text );
                var tweetURL = 'https://twitter.com/intent/tweet?via=wdtuts&url=' + docURL + '&text=' + tweetText;

                openShareWindow( tweetURL, 600, 420 );
            }

            event.preventDefault();
        } );

    </script>
</body>
</html>